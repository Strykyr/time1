Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=2, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTh1.csv', dec_in=2, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=3, enc_in=2, factor=3, features='M', folder_path='./data/water_new/', freq='h', gpu=2, individual=False, is_training=1, itr=1, label_len=25, learning_rate=0.0001, loss='mse', lradj='type1', model='Transformer', model_id='exchange_96_', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=5, pred_len=150, root_path='./data/ETT/', seq_len=100, target='OT', test_flop=False, train_epochs=15, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:2
train len >>>>>>>>  9
test len >>>>>>>>  3
>>>>>>>start training : exchange_96__Transformer_ETTm1_ftM_sl100_ll25_pl150_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 100, epoch: 1 | loss: 0.0189628
	speed: 0.2661s/iter; left time: 5632.6510s
	iters: 200, epoch: 1 | loss: 0.0142545
	speed: 0.2566s/iter; left time: 5406.9142s
	iters: 300, epoch: 1 | loss: 0.0127948
	speed: 0.2526s/iter; left time: 5298.1464s
	iters: 400, epoch: 1 | loss: 0.0111122
	speed: 0.2532s/iter; left time: 5285.3421s
	iters: 500, epoch: 1 | loss: 0.0079949
	speed: 0.2522s/iter; left time: 5237.8287s
	iters: 600, epoch: 1 | loss: 0.0090633
	speed: 0.2508s/iter; left time: 5183.3391s
	iters: 700, epoch: 1 | loss: 0.0093279
	speed: 0.2500s/iter; left time: 5141.8635s
	iters: 800, epoch: 1 | loss: 0.0086625
	speed: 0.2511s/iter; left time: 5140.2949s
	iters: 900, epoch: 1 | loss: 0.0082663
	speed: 0.2491s/iter; left time: 5075.0646s
	iters: 1000, epoch: 1 | loss: 0.0084497
	speed: 0.2490s/iter; left time: 5048.3310s
	iters: 1100, epoch: 1 | loss: 0.0069044
	speed: 0.2484s/iter; left time: 5010.3816s
	iters: 1200, epoch: 1 | loss: 0.0074899
	speed: 0.2485s/iter; left time: 4988.6415s
	iters: 1300, epoch: 1 | loss: 0.0072503
	speed: 0.2487s/iter; left time: 4967.4829s
	iters: 1400, epoch: 1 | loss: 0.0066410
	speed: 0.2490s/iter; left time: 4948.7239s
Epoch: 1 cost time: 357.8840796947479
vali>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
Epoch: 1, Steps: 1418 | Train Loss: 0.0142325 Test Loss: 0.0084831
Validation loss decreased (inf --> 0.008483).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0062466
	speed: 0.7650s/iter; left time: 15111.7465s
	iters: 200, epoch: 2 | loss: 0.0066836
	speed: 0.2495s/iter; left time: 4902.8975s
	iters: 300, epoch: 2 | loss: 0.0059998
	speed: 0.2487s/iter; left time: 4862.2561s
	iters: 400, epoch: 2 | loss: 0.0059435
	speed: 0.2484s/iter; left time: 4832.1160s
	iters: 500, epoch: 2 | loss: 0.0057975
	speed: 0.2494s/iter; left time: 4827.3712s
	iters: 600, epoch: 2 | loss: 0.0079484
	speed: 0.2505s/iter; left time: 4823.6771s
	iters: 700, epoch: 2 | loss: 0.0056131
	speed: 0.2499s/iter; left time: 4786.9324s
	iters: 800, epoch: 2 | loss: 0.0062734
	speed: 0.2502s/iter; left time: 4766.6317s
	iters: 900, epoch: 2 | loss: 0.0047344
	speed: 0.2497s/iter; left time: 4732.2355s
	iters: 1000, epoch: 2 | loss: 0.0063807
	speed: 0.2497s/iter; left time: 4707.8240s
	iters: 1100, epoch: 2 | loss: 0.0066682
	speed: 0.2494s/iter; left time: 4676.4423s
	iters: 1200, epoch: 2 | loss: 0.0051701
	speed: 0.2476s/iter; left time: 4618.5376s
	iters: 1300, epoch: 2 | loss: 0.0044678
	speed: 0.2480s/iter; left time: 4600.9560s
	iters: 1400, epoch: 2 | loss: 0.0050827
	speed: 0.2484s/iter; left time: 4583.5090s
Epoch: 2 cost time: 354.37199544906616
vali>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
Epoch: 2, Steps: 1418 | Train Loss: 0.0060309 Test Loss: 0.0095756
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0045868
	speed: 0.7581s/iter; left time: 13900.2985s
	iters: 200, epoch: 3 | loss: 0.0046344
	speed: 0.2508s/iter; left time: 4572.9964s
	iters: 300, epoch: 3 | loss: 0.0050933
	speed: 0.2507s/iter; left time: 4546.6975s
	iters: 400, epoch: 3 | loss: 0.0046350
	speed: 0.2502s/iter; left time: 4512.2948s
	iters: 500, epoch: 3 | loss: 0.0056890
	speed: 0.2504s/iter; left time: 4491.5947s
	iters: 600, epoch: 3 | loss: 0.0051446
	speed: 0.2510s/iter; left time: 4475.9776s
	iters: 700, epoch: 3 | loss: 0.0035214
	speed: 0.2493s/iter; left time: 4421.2337s
	iters: 800, epoch: 3 | loss: 0.0047771
	speed: 0.2486s/iter; left time: 4384.3099s
	iters: 900, epoch: 3 | loss: 0.0039923
	speed: 0.2484s/iter; left time: 4355.6852s
	iters: 1000, epoch: 3 | loss: 0.0043291
	speed: 0.2486s/iter; left time: 4334.4236s
	iters: 1100, epoch: 3 | loss: 0.0038148
	speed: 0.2502s/iter; left time: 4337.8802s
	iters: 1200, epoch: 3 | loss: 0.0036760
	speed: 0.2502s/iter; left time: 4312.7748s
	iters: 1300, epoch: 3 | loss: 0.0051439
	speed: 0.2499s/iter; left time: 4281.7188s
	iters: 1400, epoch: 3 | loss: 0.0044549
	speed: 0.2499s/iter; left time: 4257.5749s
Epoch: 3 cost time: 355.51622700691223
vali>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
Epoch: 3, Steps: 1418 | Train Loss: 0.0047618 Test Loss: 0.0098067
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0046987
	speed: 0.7594s/iter; left time: 12845.9251s
	iters: 200, epoch: 4 | loss: 0.0051782
	speed: 0.2514s/iter; left time: 4227.3285s
	iters: 300, epoch: 4 | loss: 0.0047792
	speed: 0.2506s/iter; left time: 4189.8735s
	iters: 400, epoch: 4 | loss: 0.0047586
	speed: 0.2513s/iter; left time: 4175.2052s
	iters: 500, epoch: 4 | loss: 0.0036578
	speed: 0.2506s/iter; left time: 4138.3892s
	iters: 600, epoch: 4 | loss: 0.0041852
	speed: 0.2479s/iter; left time: 4069.6564s
	iters: 700, epoch: 4 | loss: 0.0044942
	speed: 0.2474s/iter; left time: 4037.4142s
	iters: 800, epoch: 4 | loss: 0.0040705
	speed: 0.2471s/iter; left time: 4006.7150s
	iters: 900, epoch: 4 | loss: 0.0048367
	speed: 0.2466s/iter; left time: 3973.9033s
	iters: 1000, epoch: 4 | loss: 0.0039227
	speed: 0.2469s/iter; left time: 3955.0960s
	iters: 1100, epoch: 4 | loss: 0.0047207
	speed: 0.2477s/iter; left time: 3941.9853s
	iters: 1200, epoch: 4 | loss: 0.0055483
	speed: 0.2474s/iter; left time: 3912.4892s
	iters: 1300, epoch: 4 | loss: 0.0039721
	speed: 0.2454s/iter; left time: 3856.2480s
	iters: 1400, epoch: 4 | loss: 0.0043612
	speed: 0.2457s/iter; left time: 3837.4218s
Epoch: 4 cost time: 353.4485309123993
vali>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
Epoch: 4, Steps: 1418 | Train Loss: 0.0043369 Test Loss: 0.0097491
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0044527
	speed: 0.7878s/iter; left time: 12210.1071s
	iters: 200, epoch: 5 | loss: 0.0035148
	speed: 0.2478s/iter; left time: 3815.9947s
	iters: 300, epoch: 5 | loss: 0.0045385
	speed: 0.2482s/iter; left time: 3797.8779s
	iters: 400, epoch: 5 | loss: 0.0041976
	speed: 0.2486s/iter; left time: 3778.7136s
	iters: 500, epoch: 5 | loss: 0.0038067
	speed: 0.2485s/iter; left time: 3752.8154s
	iters: 600, epoch: 5 | loss: 0.0048040
	speed: 0.2465s/iter; left time: 3697.2686s
	iters: 700, epoch: 5 | loss: 0.0039929
	speed: 0.2482s/iter; left time: 3698.4497s
	iters: 800, epoch: 5 | loss: 0.0041949
	speed: 0.2474s/iter; left time: 3661.4245s
	iters: 900, epoch: 5 | loss: 0.0045477
	speed: 0.2441s/iter; left time: 3588.1322s
	iters: 1000, epoch: 5 | loss: 0.0044853
	speed: 0.2471s/iter; left time: 3608.0245s
	iters: 1100, epoch: 5 | loss: 0.0041154
	speed: 0.2477s/iter; left time: 3591.1943s
	iters: 1200, epoch: 5 | loss: 0.0038506
	speed: 0.2442s/iter; left time: 3516.5407s
	iters: 1300, epoch: 5 | loss: 0.0032219
	speed: 0.2430s/iter; left time: 3473.9503s
	iters: 1400, epoch: 5 | loss: 0.0038889
	speed: 0.2448s/iter; left time: 3475.4586s
Epoch: 5 cost time: 351.75083899497986
vali>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
Epoch: 5, Steps: 1418 | Train Loss: 0.0041266 Test Loss: 0.0096505
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0050696
	speed: 0.7727s/iter; left time: 10879.7408s
	iters: 200, epoch: 6 | loss: 0.0043170
	speed: 0.2492s/iter; left time: 3484.6318s
	iters: 300, epoch: 6 | loss: 0.0041603
	speed: 0.2489s/iter; left time: 3454.9830s
	iters: 400, epoch: 6 | loss: 0.0033507
	speed: 0.2475s/iter; left time: 3410.6239s
	iters: 500, epoch: 6 | loss: 0.0034507
	speed: 0.2486s/iter; left time: 3400.9166s
	iters: 600, epoch: 6 | loss: 0.0042128
	speed: 0.2487s/iter; left time: 3377.2808s
	iters: 700, epoch: 6 | loss: 0.0040579
	speed: 0.2482s/iter; left time: 3345.9438s
	iters: 800, epoch: 6 | loss: 0.0044489
	speed: 0.2482s/iter; left time: 3321.0241s
	iters: 900, epoch: 6 | loss: 0.0039518
	speed: 0.2490s/iter; left time: 3306.9922s
	iters: 1000, epoch: 6 | loss: 0.0038367
	speed: 0.2470s/iter; left time: 3255.1287s
	iters: 1100, epoch: 6 | loss: 0.0034905
	speed: 0.2470s/iter; left time: 3230.7738s
	iters: 1200, epoch: 6 | loss: 0.0048810
	speed: 0.2472s/iter; left time: 3208.4179s
	iters: 1300, epoch: 6 | loss: 0.0035069
	speed: 0.2472s/iter; left time: 3184.1914s
	iters: 1400, epoch: 6 | loss: 0.0032553
	speed: 0.2473s/iter; left time: 3160.6001s
Epoch: 6 cost time: 353.21835112571716
vali>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
Epoch: 6, Steps: 1418 | Train Loss: 0.0040138 Test Loss: 0.0096940
EarlyStopping counter: 5 out of 5
Early stopping
6
[0.014232495613461847, 0.006030857790759351, 0.004761844127319427, 0.004336901900177225, 0.00412655103530036, 0.004013759575321829]
>>>>>>>testing : exchange_96__Transformer_ETTm1_ftM_sl100_ll25_pl150_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
